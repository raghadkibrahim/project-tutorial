# Data Preprocessing {.unnumbered}

```{python}

#| echo: true
#| eval: true
#| fig-cap: "Basic row counts by year"
import pandas as pd
from pathlib import Path
from datasets import load_dataset

verdicts = load_dataset(
    "csv",
    data_files="hf://datasets/raghadkibrahim/dxb_court_data/Verdicts.csv",
    streaming=True,
    split="train",
)

```

```{python}

#| echo: true
#| eval: false
#| fig-cap: "Basic row counts by year"
import pandas as pd
from pathlib import Path

p = Path('data/raw/verdicts.csv')
df = pd.read_csv(p)

```

``` python

from sentence_transformers import SentenceTransformer

model = SentenceTransformer('sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2')

embs = model.encode(df['cleaned_recitals'].astype(str).tolist(), batch_size=256, show_progress_bar=True)

# Save to disk for FAISS/ScaNN

```

